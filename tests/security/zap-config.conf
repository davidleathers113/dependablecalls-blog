# OWASP ZAP Configuration for DCE Platform Security Testing

# Scanner configuration
scanner.strength=HIGH
scanner.maxRuleDurationInMins=10
scanner.maxScanDurationInMins=60
scanner.delayInMs=200
scanner.threadPerHost=2

# Spider configuration
spider.maxDepth=5
spider.maxChildren=20
spider.maxDuration=10
spider.maxParseSizeBytes=2621440
spider.acceptCookies=true
spider.handleParameters=USE_ALL
spider.handleODataParametersVisited=false
spider.requestWaitTime=200
spider.processForm=true
spider.postForm=true
spider.parseComments=true
spider.parseRobotsTxt=true
spider.parseSVNEntries=true
spider.parseSitemapXml=true
spider.parseGit=true
spider.skipURLString=logout,signout,exit,disconnect

# Authentication configuration
authentication.method=scriptBasedAuthentication
authentication.scriptBasedAuthentication.scriptName=DCE-Auth-Script.js
authentication.scriptBasedAuthentication.loginRequestData=email=security.test.buyer@example.com&password=SecureTestPass123!
authentication.scriptBasedAuthentication.loginURL=http://localhost:5173/api/auth/login
authentication.scriptBasedAuthentication.loggedInRegex=\\Q"authenticated"\\E.*\\Qtrue\\E
authentication.scriptBasedAuthentication.loggedOutRegex=\\Q"authenticated"\\E.*\\Qfalse\\E

# Session management
sessionManagement.method=cookieBasedSessionManagement
sessionManagement.cookieBasedSessionManagement.cookieName=session

# Context configuration
context.name=DCE-Security-Context
context.description=Security testing context for DCE platform
context.includePaths=http://localhost:5173.*,http://localhost:3000/api.*
context.excludePaths=http://localhost:5173/static.*,http://localhost:5173/assets.*,.*\\.png,.*\\.jpg,.*\\.css,.*\\.js

# Active scan policy configuration
ascanrules.sqliScanRule.strength=HIGH
ascanrules.xssScanRule.strength=HIGH
ascanrules.pathTraversalScanRule.strength=HIGH
ascanrules.remoteFileIncludeScanRule.strength=HIGH
ascanrules.serverSideIncludeScanRule.strength=HIGH
ascanrules.scriptActiveRule.strength=HIGH
ascanrules.externalRedirectRule.strength=HIGH
ascanrules.crlfInjectionRule.strength=HIGH
ascanrules.parameterPollutionRule.strength=HIGH
ascanrules.ldapInjectionRule.strength=HIGH
ascanrules.xpathInjectionRule.strength=HIGH

# Passive scan rules
pscanrules.antiCsrfTokensRule.enabled=true
pscanrules.insecureHttpMethodRule.enabled=true
pscanrules.cookieHttpOnlyRule.enabled=true
pscanrules.cookieSecureRule.enabled=true
pscanrules.cookieSameSiteRule.enabled=true
pscanrules.xFrameOptionsRule.enabled=true
pscanrules.xContentTypeOptionsRule.enabled=true
pscanrules.xXssProtectionRule.enabled=true
pscanrules.strictTransportSecurityRule.enabled=true
pscanrules.cspRule.enabled=true
pscanrules.applicationErrorDisclosureRule.enabled=true
pscanrules.sessionIdInUrlRewriteRule.enabled=true

# Plugin specific configuration
plugins.ascanrules.sqli.doUnionBased=true
plugins.ascanrules.sqli.doStackedQueries=true
plugins.ascanrules.sqli.doTimeBased=true
plugins.ascanrules.sqli.doBooleanBased=true
plugins.ascanrules.sqli.doErrorBased=true
plugins.ascanrules.sqli.doOrderByBased=true

plugins.ascanrules.xss.doReflected=true
plugins.ascanrules.xss.doStored=true
plugins.ascanrules.xss.doDom=true

# DCE-specific configuration
dce.paymentEndpoints=/api/payments.*,/api/billing.*,/api/transactions.*
dce.authEndpoints=/api/auth.*,/api/user/.*,/login,/register
dce.adminEndpoints=/api/admin.*,/admin.*
dce.apiEndpoints=/api/.*

# Security test intensity levels
intensity.quick.maxRuleDurationInMins=1
intensity.quick.maxScanDurationInMins=10
intensity.quick.strength=LOW

intensity.standard.maxRuleDurationInMins=5
intensity.standard.maxScanDurationInMins=30
intensity.standard.strength=MEDIUM

intensity.comprehensive.maxRuleDurationInMins=15
intensity.comprehensive.maxScanDurationInMins=120
intensity.comprehensive.strength=HIGH

# User agents for testing
userAgent.desktop=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
userAgent.mobile=Mozilla/5.0 (iPhone; CPU iPhone OS 14_6 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Mobile/15E148 Safari/604.1
userAgent.scanner=OWASP-ZAP-Security-Scanner/2.12.0

# Rate limiting configuration
rateLimit.requestsPerSecond=10
rateLimit.enabled=true

# Proxy configuration
proxy.chainedProxyEnabled=false
proxy.excludedDomains=localhost:5173,127.0.0.1:5173

# Certificate configuration
security.dangerousSSLEnabled=false
security.useClientCertificate=false

# Report configuration
report.template.path=/zap/wrk/report-template.html
report.include.passed=false
report.include.ignored=false
report.include.informational=true

# Advanced configuration
advanced.importCertificates=false
advanced.processForm=true
advanced.sendRefererHeader=true
advanced.handleAntiCSRFTokens=true
advanced.rescanInScopeUrls=true

# Rule thresholds
rules.10021.threshold=MEDIUM  # Persistent XSS
rules.10023.threshold=MEDIUM  # Information Disclosure
rules.10024.threshold=MEDIUM  # SQL Injection
rules.10025.threshold=MEDIUM  # Command Injection
rules.10026.threshold=MEDIUM  # Path Traversal
rules.10027.threshold=MEDIUM  # Remote File Inclusion
rules.10028.threshold=MEDIUM  # External Redirect
rules.10029.threshold=MEDIUM  # LDAP Injection
rules.10030.threshold=MEDIUM  # XPath Injection

# DCE platform specific rules
dce.rules.paymentManipulation.enabled=true
dce.rules.paymentManipulation.threshold=HIGH
dce.rules.callTrackingBypass.enabled=true
dce.rules.callTrackingBypass.threshold=HIGH
dce.rules.commissionManipulation.enabled=true
dce.rules.commissionManipulation.threshold=HIGH
dce.rules.roleEscalation.enabled=true
dce.rules.roleEscalation.threshold=HIGH

# Testing users for different roles
user.buyer.email=security.test.buyer@example.com
user.buyer.password=SecureTestPass123!
user.buyer.roles=buyer

user.supplier.email=security.test.supplier@example.com
user.supplier.password=SecureTestPass123!
user.supplier.roles=supplier

user.network.email=security.test.network@example.com
user.network.password=SecureTestPass123!
user.network.roles=network

user.admin.email=security.test.admin@example.com
user.admin.password=SecureTestPass123!
user.admin.roles=admin